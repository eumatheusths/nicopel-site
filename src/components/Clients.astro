---
// src/components/Clients.astro
import { Image } from 'astro:assets';

// 1. Carrega as imagens
const logosDict = import.meta.glob('../assets/logo-cliente-*.png', { eager: true });
const clients = Object.values(logosDict);

// 2. CONFIGURAÇÃO MATEMÁTICA (Igual ao seu código antigo)
const slideWidth = 200; // Largura de cada logo (px)
const totalLogos = clients.length; // Quantas logos tem (ex: 11)

// Largura total da pista = 200px * 11 logos * 2 (duplicata)
const trackWidth = `${slideWidth * totalLogos * 2}px`;

// Distância da animação = 200px * 11 logos (Move metade)
const moveDistance = `-${slideWidth * totalLogos}px`;
---

<section class="py-16 bg-white border-b border-gray-100 overflow-hidden">
  <div class="mx-auto max-w-7xl px-4 mb-10 text-center">
    <p class="text-lg font-medium text-gray-500 uppercase tracking-widest">
      Empresas que confiam na Nicopel
    </p>
  </div>

  <div class="relative w-full overflow-hidden bg-white">
    
    <div class="absolute inset-y-0 left-0 w-24 bg-gradient-to-r from-white to-transparent z-20 pointer-events-none"></div>
    <div class="absolute inset-y-0 right-0 w-24 bg-gradient-to-l from-white to-transparent z-20 pointer-events-none"></div>

    <div 
      class="slider-track flex" 
      style={`width: ${trackWidth};`}
    > 
      
      {/* BLOCO 1 */}
      {clients.map((client: any) => (
        <div class="flex h-[140px] w-[200px] items-center justify-center px-4 shrink-0">
          <Image 
            src={client.default} 
            alt="Cliente Nicopel" 
            width={160} 
            format="webp"
            class="max-h-24 w-auto object-contain opacity-50 grayscale transition-all duration-300 hover:grayscale-0 hover:opacity-100 hover:scale-110 cursor-pointer"
          />
        </div>
      ))}

      {/* BLOCO 2 (Cópia) */}
      {clients.map((client: any) => (
        <div class="flex h-[140px] w-[200px] items-center justify-center px-4 shrink-0">
          <Image 
            src={client.default} 
            alt="Cliente Nicopel" 
            width={160}
            format="webp"
            class="max-h-24 w-auto object-contain opacity-50 grayscale transition-all duration-300 hover:grayscale-0 hover:opacity-100 hover:scale-110 cursor-pointer"
          />
        </div>
      ))}

    </div>
  </div>
</section>

<style define:vars={{ moveDistance }}>
  @keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(var(--moveDistance)); }
  }

  .slider-track {
    animation: scroll 40s linear infinite;
  }
  
  .slider-track:hover {
    animation-play-state: paused;
  }
</style>