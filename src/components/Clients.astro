---
// src/components/Clients.astro
import { Image } from 'astro:assets';

// 1. Carrega TODAS as imagens da pasta assets que seguem o padrão
const logosDict = import.meta.glob('../assets/logo-cliente-*.png', { eager: true });

// 2. FILTRO: Lista exata baseada no seu print (1, 2, 3, 4, 6, 10, 11)
// Isso garante que só estas entrem e ignora qualquer outra
const allowedPaths = [
  '../assets/logo-cliente-1.png',
  '../assets/logo-cliente-2.png',
  '../assets/logo-cliente-3.png',
  '../assets/logo-cliente-4.png',
  '../assets/logo-cliente-6.png',
  '../assets/logo-cliente-10.png',
  '../assets/logo-cliente-11.png'
];

// Mapeia os caminhos permitidos para buscar os objetos de imagem reais
const clients = allowedPaths
  .map(path => logosDict[path]) // Busca no dicionário
  .filter(Boolean); // Remove itens undefined (caso algum arquivo da lista não exista na pasta)

// 3. CONFIGURAÇÃO MATEMÁTICA
const slideWidth = 200; 
const totalLogos = clients.length; 

const trackWidth = `${slideWidth * totalLogos * 2}px`;
const moveDistance = `-${slideWidth * totalLogos}px`;
---

<section class="py-16 bg-white border-b border-gray-100 overflow-hidden">
  <div class="mx-auto max-w-7xl px-4 mb-10 text-center">
    <p class="text-lg font-medium text-gray-500 uppercase tracking-widest">
      Empresas que confiam na Nicopel
    </p>
  </div>

  <div class="relative w-full overflow-hidden bg-white">
    
    <div class="absolute inset-y-0 left-0 w-24 bg-gradient-to-r from-white to-transparent z-20 pointer-events-none"></div>
    <div class="absolute inset-y-0 right-0 w-24 bg-gradient-to-l from-white to-transparent z-20 pointer-events-none"></div>

    <div 
      class="slider-track flex" 
      style={`width: ${trackWidth};`}
    > 
      
      {/* BLOCO 1 */}
      {clients.map((client: any) => (
        <div class="flex h-[140px] w-[200px] items-center justify-center px-4 shrink-0">
          <Image 
            src={client.default} 
            alt="Cliente Nicopel" 
            width={160} 
            format="webp"
            class="max-h-24 w-auto object-contain opacity-50 grayscale transition-all duration-300 hover:grayscale-0 hover:opacity-100 hover:scale-110 cursor-pointer"
          />
        </div>
      ))}

      {/* BLOCO 2 (Cópia) */}
      {clients.map((client: any) => (
        <div class="flex h-[140px] w-[200px] items-center justify-center px-4 shrink-0">
          <Image 
            src={client.default} 
            alt="Cliente Nicopel" 
            width={160}
            format="webp"
            class="max-h-24 w-auto object-contain opacity-50 grayscale transition-all duration-300 hover:grayscale-0 hover:opacity-100 hover:scale-110 cursor-pointer"
          />
        </div>
      ))}

    </div>
  </div>
</section>

<style define:vars={{ moveDistance }}>
  @keyframes scroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(var(--moveDistance)); }
  }

  .slider-track {
    animation: scroll 40s linear infinite;
  }
  
  .slider-track:hover {
    animation-play-state: paused;
  }
</style>